<!DOCTYPE html>
<html>
    <head>
    <!-- Title -->
    
    <title>
        Android自定义View实战之角度选择器 | Snowbean&#39;s Blog
    </title>
    
    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">
    
    <!-- Meta & INfo -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Snowbean">
    <meta name="description" content="Keep Calm and Carry on!">
    <meta name="keywords" content="null">
    
    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">
    
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Snowbean&#39;s Blog">
    
    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://wuapnjie.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Android自定义View实战之角度选择器 | Snowbean&#39;s Blog">
    <meta property="og:description" content="Keep Calm and Carry on!">
    
     <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">
        
        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->
    
    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
	body, html{
		font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
	}
	
    a{
        color: #00838F
    }
    
    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge{
        background-color: #0097A7 !important
    }
    
	/* Sidebar User Drop Down Menu Text Color */
	#scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus{
        color: #0097A7 !important
    }
    
    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover > a,
    .sidebar-colored .sidebar-nav li:hover > a i,
    .sidebar-colored .sidebar-nav li > a:hover,
    .sidebar-colored .sidebar-nav li > a:hover i,
    .sidebar-colored .sidebar-nav li > a:focus i,
    .sidebar-colored .sidebar-nav > .open > a,
    .sidebar-colored .sidebar-nav > .open > a:hover,
    .sidebar-colored .sidebar-nav > .open > a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a{
        color: #0097A7 !important
    }
    
    .toTop{
        background: #757575 !important
    }
		
	.material-layout .material-post>.material-nav,
	.material-layout .material-index>.material-nav,
	.material-nav a{
		color: #757575;
	}
		
	#scheme-Paradox .MD-burger-layer {
		background-color: #757575;
	}

	#scheme-Paradox #post-toc-trigger-btn{
		color: #757575;
	}
	
	.post-toc a:hover{
		color: #00838F;
		text-decoration: underline;
	}
</style>


<!-- Theme Background Related-->

    <style>
        body{
            background-color: #F5F5F5
        }
		
		/* blog_info bottom background */
        #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
            background-color: #fff;
        }
    </style>




<!-- Fade Effect -->

    <style>
        .fade {
            transition: all 800ms linear;
            -webkit-transform: translate3d(0,0,0);
            -moz-transform: translate3d(0,0,0);
            -ms-transform: translate3d(0,0,0);
            -o-transform: translate3d(0,0,0);
            transform: translate3d(0,0,0);
            opacity: 1;
        }

        .fade.out{
            opacity: 0;
        }
    </style>

	<script src="/js/jquery.min.js"></script>
	
	<link rel="stylesheet" href="/css/highlight/solarized-white.css">
	
	<!-- UC Browser Compatible-->
	<script>
		var agent = navigator.userAgent.toLowerCase();
		if(agent.indexOf('ucbrowser')>0) {
			document.write('<link rel="stylesheet" href="/css/uc.css">');
		   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
		}
	</script>
    
    <!-- Custom Head -->
    
</head>
	
	

    <body id="scheme-Paradox">

		
        <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
				
			
			
            <!-- Main Container -->
            <main class="material-layout__content" id="main">
				
                <!-- Top Anchor -->
                <div id="top"></div>
				
				
                <!-- Hamburger Button -->
                <button class="MD-burger-icon sidebar-toggle">
                    <span class="MD-burger-layer"></span>
                </button>
				
				
                <!-- Post TOC -->

    
	<!-- Back Button -->
<!--
	<div class="material-back" id="backhome-div" tabindex="0">
		<a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" href="#" onclick="window.history.back();return false;" target="_self" role="button" data-upgraded=",MaterialButton,MaterialRipple">
			<i class="material-icons" role="presentation">arrow_back</i>
			<span class="mdl-button__ripple-container">
				<span class="mdl-ripple"></span>
			</span>
		</a>
	</div>			
-->
	<!-- Left aligned menu below button -->
	<button id="post-toc-trigger-btn"
			class="mdl-button mdl-js-button mdl-button--icon">
	  <i class="material-icons">format_list_numbered</i>
	</button>

	<ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect"
		for="post-toc-trigger-btn">
			
			<ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#起步"><span class="post-toc-number">1.</span> <span class="post-toc-text">起步</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#思路"><span class="post-toc-number">2.</span> <span class="post-toc-text">思路</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#动手"><span class="post-toc-number">3.</span> <span class="post-toc-text">动手</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#画点"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">画点</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#画刻度上方的数字"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">画刻度上方的数字</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#画当前角度"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">画当前角度</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#动起来"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">动起来</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#扩展"><span class="post-toc-number">3.5.</span> <span class="post-toc-text">扩展</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#总结"><span class="post-toc-number">4.</span> <span class="post-toc-text">总结</span></a></li></ol>
		
<!--			<li class="mdl-menu__item">Some Action</li>-->
	</ul>



<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">
		
        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
	<!-- Paradox Post Header -->
	
		
			<!-- Random Thumbnail -->
			<div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
				<script>
    
    var randomNum;
    randomNum = Math.floor(Math.random() * 5 + 1);
    
    $(".post_thumbnail-random").css('background-image', 'url(' + '/img/random/' + randomNum + '.png' + ')');
    
</script>

		
	
        <p class="article-headline-p">
            Android自定义View实战之角度选择器
        </p>
    </div>

	

				
				
					<!-- Paradox Post Info -->
					<div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">
    
    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Snowbean</strong>
        <span>11月 05, 2016</span>
    </div>
    
    <div class="section-spacer"></div>
	
    <!-- Favorite -->
<!--
    <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
        <i class="material-icons" role="presentation">favorite</i>
        <span class="visuallyhidden">favorites</span>
    </button>
-->
    
    <!-- Tags (bookmark) -->
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/Android/">Android</a>
    </ul>
    
    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    
    
    
    
    
    <!-- Share Twitter -->
    <a class="post_share-link" href="https://twitter.com/intent/tweet?text=Android自定义View实战之角度选择器&url=http://wuapnjie.github.io//2016/11/05/Android自定义View实战之角度选择器/index.html&via=Snowbean" target="_blank">
        <li class="mdl-menu__item">
            分享到 Twitter
        </li>
    </a>
    
    <!-- Share Google+ -->
    <a class="post_share-link" href="https://plus.google.com/share?url=http://wuapnjie.github.io//2016/11/05/Android自定义View实战之角度选择器/index.html" target="_blank">
        <li class="mdl-menu__item">
            分享到 Google+
        </li>
    </a>
    
    <!-- Share Weibo -->
    <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=Android自定义View实战之角度选择器&url=http://wuapnjie.github.io//2016/11/05/Android自定义View实战之角度选择器/index.html&pic=&searchPic=false&style=simple" target="_blank">
        <li class="mdl-menu__item">
            分享到微博
        </li>
    </a>
</ul>
</div>
				

                <!-- Post Content -->
                <div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out">
	
		<hr>
<p>本文比较基础，在阅读本文前只需要掌握最基础的自定义View知识和Android事件知识。</p>
<h3 id="起步"><a href="#起步" class="headerlink" title="起步"></a>起步</h3><p>有一天晚上，在Google Photos查看照片，用了一下它的图片剪裁功能，于是我马上就被其界面和操作吸引。</p>
<p><img src="http://7xrqmj.com1.z0.glb.clouddn.com/gpcrop.png?imageView2/2/w/360" alt=""></p>
<p>第二天我就想模仿做一个这样的裁图库，当然，我做了。同时也做了一个和Google Photos裁图页面几乎一模一样的角度选择器。那么，来看一下最终的效果：</p>
<p><img src="http://7xrqmj.com1.z0.glb.clouddn.com/DegreeSeekbar.gif" alt=""></p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>仔细观察这个效果，先分析构成结构，我把它分成三部分：</p>
<ol>
<li>表示刻度的点</li>
<li>相应点上方的数字</li>
<li>控件中央的当前刻度与三角</li>
</ol>
<p>可以看出，构成元素十分简单，不涉及图片，<code>Drawable</code>，那么只需要用<code>Canvas</code>画出来就好了。</p>
<p>接下来观察手势的操作，查看随着手指滑动，控件做出的变化，这里的变化有：</p>
<ol>
<li>手指按上去时，部分区域变亮（部分区域即为可见区域）</li>
<li>随着手指滑动，相应的数字发生移动，当前角度值也发生改变</li>
<li>离中心越近，透明度越低，且<code>0°</code>的下方的点要大一些</li>
</ol>
<p>好了，我们对这个控件已经分析的很透彻了，根据分析，首先我们要在<code>View</code>的<code>onDraw()</code>方法中画出构成元素，之后要让它动起来，在<code>onTouchEvent()</code>方法中监听手势，改变一些值并重绘我们的<code>View</code>，这里很明显，我们要改变的肯定是当前角度这个值。</p>
<h3 id="动手"><a href="#动手" class="headerlink" title="动手"></a>动手</h3><p>既然有了思路，那么就要马上动手，不然下次忘记掉了怎么办？</p>
<h4 id="画点"><a href="#画点" class="headerlink" title="画点"></a>画点</h4><p>首先，先把点给画出来，位置很简单，肯定是从视图中心开始画，往左往右分别画点。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mPointCount; i++) &#123;</div><div class="line">	canvas.getClipBounds(mCanvasClipBounds);</div><div class="line">   canvas.drawPoint(mCanvasClipBounds.centerX() + (i - mPointCount / <span class="number">2</span>) * mPointMargin,</div><div class="line">                    mCanvasClipBounds.centerY(), mPointPaint);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其中<code>mPointCount</code>为所要画的点个数，这里默认为51个，<code>mPointMargin</code>为两点间的边距，长度为<code>View</code>的宽度除以点的个数。</p>
<p>看看效果</p>
<p><img src="http://7xrqmj.com1.z0.glb.clouddn.com/degree1.png?imageView2/1/w/360" alt=""></p>
<p>嗯，成功的把点给画出来了。</p>
<h4 id="画刻度上方的数字"><a href="#画刻度上方的数字" class="headerlink" title="画刻度上方的数字"></a>画刻度上方的数字</h4><p>既然把点给画出来了，根据我们的思路，我们要把数字给画到正确的位置上，画数字当然很简单，这里难的是找到正确的位置。</p>
<p>首先，我们的数字是会移动的，随着当前角度的不同，所展示的数字大小位置都不同。但毫无疑问的是，这个位置（x坐标）肯定是关于当前角度的一个函数。至于具体是一个什么样的函数，相信聪明的你很快就可以分析出来，毕竟只是一个线性关系，这里就直接贴代码了。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawDegreeText</span><span class="params">(<span class="keyword">int</span> degrees, Canvas canvas, <span class="keyword">boolean</span> canReach)</span> </span>&#123;</div><div class="line">    canvas.drawText(degrees + <span class="string">"°"</span>,</div><div class="line">                getWidth() / <span class="number">2</span> + mPointMargin * degrees / <span class="number">2</span> - mTextWidths[<span class="number">0</span>] / <span class="number">2</span> * <span class="number">3</span> - mCurrentDegrees / <span class="number">2</span> * mPointMargin,</div><div class="line">                 getHeight() / <span class="number">2</span> - <span class="number">10</span>,</div><div class="line">                 mTextPaint);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>按照我们的效果，我们需要画出-90°~90°的刻度，其中-45°～45°是可到达角度，另外的角度不可到达。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">drawDegreeText(<span class="number">0</span>, canvas, <span class="keyword">true</span>);</div><div class="line">drawDegreeText(<span class="number">15</span>, canvas, <span class="keyword">true</span>);</div><div class="line">drawDegreeText(<span class="number">30</span>, canvas, <span class="keyword">true</span>);</div><div class="line">drawDegreeText(<span class="number">45</span>, canvas, <span class="keyword">true</span>);</div><div class="line">drawDegreeText(-<span class="number">15</span>, canvas, <span class="keyword">true</span>);</div><div class="line">drawDegreeText(-<span class="number">30</span>, canvas, <span class="keyword">true</span>);</div><div class="line">drawDegreeText(-<span class="number">45</span>, canvas, <span class="keyword">true</span>);</div><div class="line"></div><div class="line">drawDegreeText(<span class="number">60</span>, canvas, <span class="keyword">false</span>);</div><div class="line">drawDegreeText(<span class="number">75</span>, canvas, <span class="keyword">false</span>);</div><div class="line">drawDegreeText(<span class="number">90</span>, canvas, <span class="keyword">false</span>);</div><div class="line">drawDegreeText(-<span class="number">60</span>, canvas, <span class="keyword">false</span>);</div><div class="line">drawDegreeText(-<span class="number">75</span>, canvas, <span class="keyword">false</span>);</div><div class="line">drawDegreeText(-<span class="number">90</span>, canvas, <span class="keyword">false</span>);</div></pre></td></tr></table></figure>
<p>好了，来看一下效果，可以看到，数字被画在了正确的位置。</p>
<p><img src="http://7xrqmj.com1.z0.glb.clouddn.com/degree2.png?imageView2/1/w/360" alt=""></p>
<h4 id="画当前角度"><a href="#画当前角度" class="headerlink" title="画当前角度"></a>画当前角度</h4><p>这个超级简单呢，位置也特别好确定，上方三角形的Path也非常好知道，但是这里要注意的是，当当前角度为0°左右时，不应该把0°刻度显示出来。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="comment">//画当前角度</span></div><div class="line"><span class="keyword">if</span> (mCurrentDegrees &gt;= <span class="number">10</span>) &#123;</div><div class="line">    canvas.drawText(mCurrentDegrees + <span class="string">"°"</span>, getWidth() / <span class="number">2</span> - mTextWidths[<span class="number">0</span>], mBaseLine, mTextPaint);</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (mCurrentDegrees &lt;= -<span class="number">10</span>) &#123;</div><div class="line">    canvas.drawText(mCurrentDegrees + <span class="string">"°"</span>, getWidth() / <span class="number">2</span> - mTextWidths[<span class="number">0</span>] / <span class="number">2</span> * <span class="number">3</span>, mBaseLine, mTextPaint);</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (mCurrentDegrees &lt; <span class="number">0</span>) &#123;</div><div class="line">    canvas.drawText(mCurrentDegrees + <span class="string">"°"</span>, getWidth() / <span class="number">2</span> - mTextWidths[<span class="number">0</span>], mBaseLine, mTextPaint);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    canvas.drawText(mCurrentDegrees + <span class="string">"°"</span>, getWidth() / <span class="number">2</span> - mTextWidths[<span class="number">0</span>] / <span class="number">2</span>, mBaseLine, mTextPaint);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//三角指示器的Path</span></div><div class="line">mIndicatorPath.moveTo(w / <span class="number">2</span>, h / <span class="number">2</span> + mFontMetrics.top / <span class="number">2</span> - <span class="number">18</span>);</div><div class="line">mIndicatorPath.rLineTo(-<span class="number">8</span>, -<span class="number">8</span>);</div><div class="line">mIndicatorPath.rLineTo(<span class="number">16</span>, <span class="number">0</span>);</div></pre></td></tr></table></figure>
<p>还有一个小细节，就是离中心越近，其透明度越来越低，也就是说，我们要根据离中心的位置，来改变画笔<code>Paint</code>的<code>alpha</code>值，再将点画出。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mPointCount; i++) &#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (i &gt; zeroIndex - <span class="number">22</span> &amp;&amp; i &lt; zeroIndex + <span class="number">22</span> &amp;&amp; mScrollStarted) &#123;</div><div class="line">        mPointPaint.setAlpha(<span class="number">255</span>);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        mPointPaint.setAlpha(<span class="number">100</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (i &gt; mPointCount / <span class="number">2</span> - <span class="number">8</span> &amp;&amp; i &lt; mPointCount / <span class="number">2</span> + <span class="number">8</span></div><div class="line">             &amp;&amp; i &gt; zeroIndex - <span class="number">22</span> &amp;&amp; i &lt; zeroIndex + <span class="number">22</span>) &#123;</div><div class="line">        <span class="keyword">if</span> (mScrollStarted)</div><div class="line">             mPointPaint.setAlpha(Math.abs(mPointCount / <span class="number">2</span> - i) * <span class="number">255</span> / <span class="number">8</span>);</div><div class="line">        <span class="keyword">else</span></div><div class="line">             mPointPaint.setAlpha(Math.abs(mPointCount / <span class="number">2</span> - i) * <span class="number">100</span> / <span class="number">8</span>);</div><div class="line">    &#125;</div><div class="line">    ……</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这时，已经很像了，只是还不能动。</p>
<p><img src="http://7xrqmj.com1.z0.glb.clouddn.com/degree3.png?imageView2/1/w/360" alt=""></p>
<h4 id="动起来"><a href="#动起来" class="headerlink" title="动起来"></a>动起来</h4><p>该绘制的部分我们已经都绘制起来了，是时候让这个View动起来了，角度选择器的触摸事件不复杂，我们只需要在我们移动手指的时候根据滑动距离来改变当前角度值并重绘视图就可以看到移动效果了。为什么呢？因为我们之前在画数字的时候，位置都是由当前角度这个值决定的，所以它一发生变化，数字的位置也会发生改变。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</div><div class="line">    <span class="keyword">switch</span> (event.getAction()) &#123;</div><div class="line">     ……</div><div class="line">        <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</div><div class="line">            <span class="keyword">float</span> distance = event.getX() - mLastTouchedPosition;</div><div class="line">            ……</div><div class="line">            <span class="keyword">if</span> (distance != <span class="number">0</span>) &#123;</div><div class="line">                onScrollEvent(event, distance);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">      ……</div><div class="line">      <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">onScrollEvent</span><span class="params">(MotionEvent event, <span class="keyword">float</span> distance)</span> </span>&#123;</div><div class="line">    mTotalScrollDistance -= distance;</div><div class="line">    postInvalidate();</div><div class="line">    mLastTouchedPosition = event.getX();</div><div class="line">    mCurrentDegrees = (<span class="keyword">int</span>) ((mTotalScrollDistance * mDragFactor) / mPointMargin);</div><div class="line">    <span class="keyword">if</span> (mScrollingListener != <span class="keyword">null</span>) &#123;</div><div class="line">        mScrollingListener.onScroll(mCurrentDegrees);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当然你还需要处理一些细节性的东西，比如在数字移动的时候，靠近中心一定范围就会消失（透明度变为0），这些都是很容易控制的，只要改变画笔的透明度就好了，但是正是对细节的把控，才能做出一个效果让用户满意的自定义View。最后，再来看一下效果。</p>
<p><img src="http://7xrqmj.com1.z0.glb.clouddn.com/DegreeSeekbar.gif" alt=""></p>
<h4 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h4><p>到这里，我们做的角度选择器已经和Google Photos的几乎一模一样了，但是，仅仅这样就够了。不，不够，我们还要继续扩展，为什么只能达到正负45°，我们要所有的范围自由选择，也就是-180°～180°，然后数字颜色啊，点的颜色啊都要让人自由选择。所以我们要扩展我们的角度选择器，把一切可以变化的接口暴露出来。</p>
<p>最后看一下我们多种多样的角度选择器，还是挺好看呀～</p>
<p><img src="http://7xrqmj.com1.z0.glb.clouddn.com/DegreeSeekBar2.gif" alt=""></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>这次的自定义View相对于前两次的来说，无疑是简单了很多，只运用了最基础的绘图知识和事件机制，但是看起来效果也还不错哦，嘿嘿，反正我特别喜欢这个角度选择器，虽然我还不知道除了裁图页面可以用到还有哪里可以用到。所以说运用最简单的知识，也可以组合出比较复杂的效果，希望大家多发挥自己的想象力，一起自定义出更多好玩的，实用的，酷炫的控件吧。</p>
<p>希望这篇文章对你有帮助，哪怕只是一些启发，我也很开心了。</p>
<p>最后附上源码地址：<a href="https://github.com/wuapnjie/DegreeSeekBar" target="_blank" rel="external">https://github.com/wuapnjie/DegreeSeekBar</a></p>

	
	
	
	
</div>
				
				

                <!-- Post Comments -->
                
                    
    <!-- 使用多说评论 -->
    <link rel="stylesheet" href="/css/duoshuo.min.css">
<style>
    #ds-thread #ds-reset .ds-post-button{
        background-color: #0097A7 !important;
    }
    #ds-wrapper #ds-reset .ds-icons-32{
        background-color: #0097A7 !important;
    }
    #ds-reset .ds-highlight {
        color: #0097A7 !important;
    }
</style>
<div id="comments">
    <!-- 多说评论框 start -->
        <div class="ds-thread" 
            data-thread-key="2016/11/05/Android自定义View实战之角度选择器/" 
            data-url="http://wuapnjie.github.io/2016/11/05/Android自定义View实战之角度选择器/"
            data-title="Android自定义View实战之角度选择器"></div>
    <!-- 多说评论框 end -->
</div>



                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    
    <!-- Prev Nav -->
    
        <a href="/2016/11/07/Android轻松实现RecyclerView悬浮条/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2016/11/02/Android自定义View实战之PuzzleView/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>
        </div>
    </div>

				
				
					<!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay "></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored  sidebar-fixed-left" role="navigation">
	<div id="sidebar-main">
	    <!-- Sidebar Header -->
		<div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
    <i class="material-icons">clear_all</i>
    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="Snowbean's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        wupanjie0611@email.com
        <b class="caret"></b>
    </a>
</div>

		<!-- Sidebar Navigation  -->
		<ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
			
                <li>
                    <a href="#" target="_blank" title="Email Me">
						<i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    <li id="sidebar-first-li">
        <a href="/" target="_self">
            <i class="material-icons sidebar-material-icons">home</i>
             主页
        </a>
    </li>

    <!-- I'm Feeling Lucky -->
<!--
    <li class="dropdown">
        <a href="" target="_self">
            <i class="material-icons sidebar-material-icons">explore</i>
             sidebar.imlucky
        </a>
    </li>
-->

	
    <!-- Archives  -->
    <li class="dropdown">
        <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">inbox</i>
             归档
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li>
            <a class="sidebar_archives-link" href="/archives/2017/01/">一月 2017<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/12/">十二月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/11/">十一月 2016<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">九月 2016<span class="sidebar_archives-count">6</span></a>
        </ul>
    </li>

    <!-- Divider -->
    <li class="divider"></li>


    <!-- Pages  -->
	

    <!-- Article Numebr  -->
    <li>
        <a href="/archives">
             文章总数
             <span class="sidebar-badge">21</span>
        </a>
    </li>
</ul>

		<!-- Sidebar Divider -->
		<div class="sidebar-divider"></div>

		<!-- Sidebar Footer -->
		<!-- 
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持。 :) 
-->

<!-- Theme Material -->
<a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
	<div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		主题 - Material
		<span class="sidebar-badge badge-circle">i</span>
	</div>
</a>

<!-- Help & Support -->
<!--
<a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		sidebar.help
		<span class="mdl-button__ripple-container">
			<span class="mdl-ripple"></span>
		</span>
	</div>
</a>
-->

<!-- Feedback -->
<!--
<a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.feedback
                    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>
-->

<!-- Abount Theme -->
<!--
<a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.about_theme
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>-->

	</div>
    
    <!-- Sidebar Sponsor -->
    


</aside>

				
				
				
					<!-- Footer Top Button -->
					<div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>
				
				
				<!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
	
	
		<!-- Paradox Footer Left Section -->
		<div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
    <a href="https://twitter.com/twitter" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-twitter.png);">
        <span class="visuallyhidden">Twitter</span>
    </button></a>
    
    
    <!-- Facebook -->
    
    <a href="https://www.facebook.com/facebook" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-facebook.png);">
        <span class="visuallyhidden">Facebook</span>
    </button></a>
    
    
    <!-- Google + -->
    
    <a href="https://www.google.com/" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-gplus.png);">
        <span class="visuallyhidden">Google Plus</span>
    </button></a>
    
    
    <!-- Weibo -->
    
    
    
    <!-- Instagram -->
    
    
    
    <!-- Tumblr -->
    
    
    
    <!-- Github -->
    
    <a href="https://github.com/wuapnjie" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.png);">
        <span class="visuallyhidden">Github</span>
    </button></a>
    
</div>


		<!--Copyright-->
		<div id="copyright">Copyright&nbsp;©&nbsp;<script type="text/javascript">var fd = new Date();document.write(fd.getFullYear());</script>&nbsp;Snowbean's Blog</div>

		<!-- Paradox Footer Right Section -->

		<!-- 
		I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright.
		It will not impact the appearance and can give developers a lot of support :)

		很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
		它不会影响美观并可以给开发者很大的支持。 :) 
		-->

		<div class="mdl-mini-footer--right-section">
			<div>
				<div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
				<div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
			</div>
		</div>
	
    
</footer>
                
				<!-- Import File -->
<script src="/js/highlight.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    
    $('#nprogress .bar').css({
        'background': '#FF4081'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #FF4081, 0 0 15px #FF4081'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#FF4081',
        'border-left-color': '#FF4081'
    });
    
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>








    <!-- 多说公共 js 代码 start -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"wuapnjie"};
        (function() {
            var ds = document.createElement('script');
            ds.type = 'text/javascript';ds.async = true;
            ds.src = 'https://static.duoshuo.com/embed.js';
            ds.charset = 'UTF-8';
            (document.getElementsByTagName('head')[0] 
             || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
    </script>
    <!-- 多说公共 js 代码 end -->




<!-- Swiftye -->


<!-- Local Search-->


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $(".post-toc-wrap").parent(".mdl-menu__container").css("position", "fixed");
    });
</script>

<!-- MathJax Load-->

            </main>
        </div>
		
    </body>
		
	
</html>
